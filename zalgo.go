package gostringconverters

import (
	"math/rand"
	"strings"
)

var (
	zalgoCharList = []rune{
		'\u0300',
		'\u0301',
		'\u0302',
		'\u0303',
		'\u0304',
		'\u0305',
		'\u0306',
		'\u0307',
		'\u0308',
		'\u0309',
		'\u030A',
		'\u030B',
		'\u030C',
		'\u030D',
		'\u030E',
		'\u030F',
		'\u0310',
		'\u0311',
		'\u0312',
		'\u0313',
		'\u0314',
		'\u0315',
		'\u031A',
		'\u031B',
		'\u033D',
		'\u033E',
		'\u033F',
		'\u0340',
		'\u0341',
		'\u0342',
		'\u0343',
		'\u0344',
		'\u0346',
		'\u034A',
		'\u034B',
		'\u034C',
		'\u0350',
		'\u0351',
		'\u0352',
		'\u0357',
		'\u0358',
		'\u035B',
		'\u035D',
		'\u035E',
		'\u0360',
		'\u0361',
		'\u0316',
		'\u0317',
		'\u0318',
		'\u0319',
		'\u031C',
		'\u031D',
		'\u031E',
		'\u031F',
		'\u0320',
		'\u0321',
		'\u0322',
		'\u0323',
		'\u0324',
		'\u0325',
		'\u0326',
		'\u0327',
		'\u0328',
		'\u0329',
		'\u032A',
		'\u032B',
		'\u032C',
		'\u032D',
		'\u032E',
		'\u032F',
		'\u0330',
		'\u0331',
		'\u0332',
		'\u0333',
		'\u0339',
		'\u033A',
		'\u033B',
		'\u033C',
		'\u0345',
		'\u0347',
		'\u0348',
		'\u0349',
		'\u034D',
		'\u034E',
		'\u0353',
		'\u0354',
		'\u0355',
		'\u0356',
		'\u0359',
		'\u035A',
		'\u035C',
		'\u035F',
		'\u0362',
		'\u0334',
		'\u0335',
		'\u0336',
		'\u0337',
		'\u0338',
		'\u0363',
		'\u0364',
		'\u0365',
		'\u0366',
		'\u0367',
		'\u0368',
		'\u0369',
		'\u036A',
		'\u036B',
		'\u036C',
		'\u036D',
		'\u036E',
		'\u036F',
	}

	numZalgoChars = len(zalgoCharList)

	zalgoCharMap = map[rune]bool{
		'\u0300': true,
		'\u0301': true,
		'\u0302': true,
		'\u0303': true,
		'\u0304': true,
		'\u0305': true,
		'\u0306': true,
		'\u0307': true,
		'\u0308': true,
		'\u0309': true,
		'\u030A': true,
		'\u030B': true,
		'\u030C': true,
		'\u030D': true,
		'\u030E': true,
		'\u030F': true,
		'\u0310': true,
		'\u0311': true,
		'\u0312': true,
		'\u0313': true,
		'\u0314': true,
		'\u0315': true,
		'\u031A': true,
		'\u031B': true,
		'\u033D': true,
		'\u033E': true,
		'\u033F': true,
		'\u0340': true,
		'\u0341': true,
		'\u0342': true,
		'\u0343': true,
		'\u0344': true,
		'\u0346': true,
		'\u034A': true,
		'\u034B': true,
		'\u034C': true,
		'\u0350': true,
		'\u0351': true,
		'\u0352': true,
		'\u0357': true,
		'\u0358': true,
		'\u035B': true,
		'\u035D': true,
		'\u035E': true,
		'\u0360': true,
		'\u0361': true,
		'\u0316': true,
		'\u0317': true,
		'\u0318': true,
		'\u0319': true,
		'\u031C': true,
		'\u031D': true,
		'\u031E': true,
		'\u031F': true,
		'\u0320': true,
		'\u0321': true,
		'\u0322': true,
		'\u0323': true,
		'\u0324': true,
		'\u0325': true,
		'\u0326': true,
		'\u0327': true,
		'\u0328': true,
		'\u0329': true,
		'\u032A': true,
		'\u032B': true,
		'\u032C': true,
		'\u032D': true,
		'\u032E': true,
		'\u032F': true,
		'\u0330': true,
		'\u0331': true,
		'\u0332': true,
		'\u0333': true,
		'\u0339': true,
		'\u033A': true,
		'\u033B': true,
		'\u033C': true,
		'\u0345': true,
		'\u0347': true,
		'\u0348': true,
		'\u0349': true,
		'\u034D': true,
		'\u034E': true,
		'\u0353': true,
		'\u0354': true,
		'\u0355': true,
		'\u0356': true,
		'\u0359': true,
		'\u035A': true,
		'\u035C': true,
		'\u035F': true,
		'\u0362': true,
		'\u0334': true,
		'\u0335': true,
		'\u0336': true,
		'\u0337': true,
		'\u0338': true,
		'\u0363': true,
		'\u0364': true,
		'\u0365': true,
		'\u0366': true,
		'\u0367': true,
		'\u0368': true,
		'\u0369': true,
		'\u036A': true,
		'\u036B': true,
		'\u036C': true,
		'\u036D': true,
		'\u036E': true,
		'\u036F': true,
	}
)

// ZalgoEncoder - Will convert a string to Zalgo format
// with numChars number of characters per rune
func ZalgoEncoder(s string, numChars int) string {
	var builder strings.Builder
	for _, r := range s {
		builder.WriteRune(r)
		for i := 0; i < numChars; i++ {
			builder.WriteRune(zalgoCharList[rand.Intn(numZalgoChars)])
		}
	}
	return builder.String()
}

// ZalgoDecoder - Will convert a Zalgo string to regular
// not very smart. It will get rid of all diacritical marks
func ZalgoDecoder(s string) string {
	var builder strings.Builder
	for _, r := range s {
		_, found := zalgoCharMap[r]
		if !found {
			builder.WriteRune(r)
		}
	}
	return builder.String()
}
